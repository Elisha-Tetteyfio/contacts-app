<div class="page">
  <p style="color: green"><%= notice %></p>

  <div class="contactTop flex-row-reverse">
    <div class="dropdown mt-2">
      <button class="btn contactNew dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        Filter suburb
      </button>
      <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
      <div>
        <%= link_to "All", contacts_path, inner_html: {class: "text-decoration-none"} %>  
      </div>
        <% @suburbs.each do |suburb| %>
          <div>
            <%= link_to suburb.name, "/contacts/suburb/#{suburb.id}", inner_html: {class: "text-decoration-none"} %>  
          </div>
        <% end %>
      </div>
    </div>
    <div class="contactNew btn align-right mt-2">
      <%= link_to "+ Add contact", new_contact_path %>
    </div>
  </div>

  <div>
    <% if @contacts.empty? %>
      <h3 class="font-italic font-monospace font-weight-lighter mt-4">You have no contacts!</h3>
    <% else %>
    <fieldset id="contacts" data-controller="region">
      <legend class="mb-4" style="color: rgb(72, 72, 116);">My contacts</legend>
      <hr>
      <table class="table table-striped">
        <thead>
          <tr>
            <th class="header">#</th>
            <th class="header">Name</th>
            <th class="header">Contact details</th>
            <th class="header">Location</th>
          </tr>
        </thead>
        <tbody>
          <% i = 1 %>
          <% @contacts.each do |contact| %>
          <% if params[:page].to_i <= 0 %>
            <% no = i %>
          <% else %>
            <% no = 5*(params[:page].to_i - 1) + i %>
          <% end %>
            <tr>
              <td> <%= no %> </td>
              <td> <%= contact.fname %> <%= contact.lname %>  </td>
              <td> 
                <%= contact.phone %> 
                <div class="contactSec"><%= contact.email %></div>
              </td>
              <td> 
                <%= contact.suburb.name %> 
                <div class="contactSec"><%= contact.suburb.city.name %>, <%= contact.suburb.city.region.name %></div>
              </td>
              <td> 
                <div class="actions">
                    <%= link_to raw("<i class=\"bi-eye btn border\"></i>"), contact%>
                    <%= link_to raw("<i class=\"bi-pen btn border\"></i>"), edit_contact_path(contact)%>
                    <button type="button" class="btn border" data-bs-target="#confirmationModal" data-bs-toggle="modal" action= "click->region#modall" >
                      <i class="bi-trash"></i>
                    </button>
                    <%#= button_to raw("<i class='bi bi-trash' data-bs-target='#confirmationModal' data-bs-toggle='modal'></i> Delete"), contact_path(contact),
                    class: "btn border", 
                    data: {action: "click->region#modall"}
                    
                      %>
                    <div class="modal fade" id="confirmationModal" tabindex="-1" 
                      aria-labelledby="confirmationModalLabel" aria-hidden="true">
                        <div class="modal-dialog"> 
                          <div class="modal-content">                      
                            <div class="modal-header"> 
                            <h3>Confirmation</h3>                       
                            </div>                      
                            <div class="modal-body"> 
                            <%#= render "contacts/menu", contact: contact %>
                            <div> Do you want to delete this contact? </div>                       
                            </div>                      
                            <div class="modal-footer">  
                                                  
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>                        
                              <%= button_to raw("<i class=\"bi bi-trash\"></i> Delete"), contact_path(contact), class: "btn btn-danger", method: :delete, data: { confirm: "Are you sure you want to delete this contact?" } %>                      
                      </div>
                    </div>
                  </div>
                </div> 
                  </div>  
                </div>
              </td>
            </tr>
            <% i += 1 %>
          <% end %>
        </tbody>
      </table>
      <%= will_paginate @contacts, class: " btn", previous_label: "<", next_label: ">", link_separator: " | ", inner_window: 0 %>
    </fieldset>
  <% end %>
</div>


<!--button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#confirmationModal">
  <i class="bi bi-trash"></i>                
</!--button>-->
<!-- Modal -->



